<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>VM Usage - How To Poweredge 1950 III</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body class="homepage" >

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="..">How To Poweredge 1950 III</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../hardware/">Overview</a>
</li>

                        
                            
<li >
    <a href="../hardware/gpu/">GPU Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">VM Usage</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../hardware/gpu/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/SashaNullptr/How-To-Poweredge-1950-III/edit/master/docs/vm_usage/index.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#hosting-a-hypervisor">Hosting a Hypervisor</a></li>
            <li class="second-level"><a href="#motivation">Motivation</a></li>
                
            <li class="second-level"><a href="#installing-a-base-image">Installing a Base Image</a></li>
                
            <li class="second-level"><a href="#setting-up-kvm">Setting up KVM</a></li>
                
            <li class="second-level"><a href="#install-kvm-and-supporting-utilities">Install KVM and Supporting Utilities</a></li>
                
            <li class="second-level"><a href="#install-virt-mananger">Install Virt-Mananger</a></li>
                
            <li class="second-level"><a href="#set-up-a-network-bridge">Set up a Network Bridge</a></li>
                
                <li class="third-level"><a href="#public-virtual-bridge">Public Virtual Bridge</a></li>
            <li class="second-level"><a href="#set-up-pcie-pass-through">Set up PCIe Pass-through</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="hosting-a-hypervisor">Hosting a Hypervisor</h1>
<h2 id="motivation">Motivation</h2>
<p>So you have a big, fairly high-tech ( for 2009 ) 1U rack server set-up -- now what?
You could run one gigantic bare-metal single OS, but that would almost certainly be
inflexible and insecure. A more flexible approach, that is still fairly close to metal,
is to run a hypervisor, like <a href="https://www.xenproject.org/">Xen</a> or <a href="https://www.linux-kvm.org/page/Main_Page">KVM</a>.</p>
<h2 id="installing-a-base-image">Installing a Base Image</h2>
<p>We will be using Debian Linux as our base image, for entirely
preferential reasons. The rest of the guide will only apply to Debian systems
but should provide a good template for other systems as well.</p>
<h2 id="setting-up-kvm">Setting up KVM</h2>
<h2 id="install-kvm-and-supporting-utilities">Install KVM and Supporting Utilities</h2>
<pre><code class="shell">sudo apt-get install qemu-kvm libvirt-clients libvirt-daemon-system bridge-utils
</code></pre>

<h2 id="install-virt-mananger">Install Virt-Mananger</h2>
<p>While not strictly necessary <code>virt-manager</code> provides a GUI for provisioning and
monitoring VMs.</p>
<pre><code class="shell">sudo apt-get install virt-manager
</code></pre>

<h2 id="set-up-a-network-bridge">Set up a Network Bridge</h2>
<p>In order for any of our VMs to have network access we need to set up a network bridge
to our host system. There are quite a few ways to do this, but one of the most
straight-forward ways is to edit <code>/etc/network/interfaces</code> and set up a network bridge.
Note that <code>eth0</code> in the example files is just the name of the Ethernet
adapter. The Poweredge 1950 has <em>two</em> NICs built-in which are labeled <code>eth0</code> and
<code>eth1</code>so we could have just as easily used <code>eth1</code>.</p>
<p>Further note that Ethernet adapter names are <em>not</em> guaranteed to be consistent across OSes and hardware. If this guide is being adapted to other hardware of systems the name will
need to be resolved and <code>eth0</code> will need to be replaced in the interface file.
To list all network interface devices, simply use <code>ls /sys/class/net</code>.</p>
<h3 id="public-virtual-bridge">Public Virtual Bridge</h3>
<p>In general not only want our VMs to be able to access network resources, but we
also want to be able to access them without needing to go through the host machine.
In order to do this we need a public bridge, which will expose any guest VMs on
as machines on the same network as the host.</p>
<p>Below is an example interfaces that will set-up a public bridge. Whenever we
modify the <code>/etc/network/interfaces</code> file we will need to reboot the host machine
or run <code>/etc/init.d/networking restart</code>.</p>
<pre><code class="shell"># /etc/network/interfaces
# interfaces(5) file used by ifup(8) and ifdown(8)
auto lo br0
iface lo inet loopback

iface eth0 inet manual

iface br0 inet dhcp
    bridge_ports    eth0
    bridge_stp      off
    bridge_maxwait  0
    bridge_fd       0
</code></pre>

<h2 id="set-up-pcie-pass-through">Set up PCIe Pass-through</h2></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>
    <script src="../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2018-09-30 04:44:22
-->
