<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Provisioning - How To Poweredge 1950 III</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body class="homepage" >

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="..">How To Poweredge 1950 III</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../hardware/">Overview</a>
</li>

                        
                            
<li >
    <a href="../hardware/gpu/">GPU Usage</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Provisioning</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../hardware/gpu/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/SashaNullptr/How-To-Poweredge-1950-III/edit/master/docs/provisioning/index.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#provisioning">Provisioning</a></li>
            <li class="second-level"><a href="#initial-set-up">Initial Set-Up</a></li>
                
            <li class="second-level"><a href="#disk-partitioning-scheme">Disk Partitioning Scheme</a></li>
                
                <li class="third-level"><a href="#setting-up-raid-arrays">Setting up RAID Arrays</a></li>
                <li class="third-level"><a href="#setting-up-extra-sata-hdd">Setting up Extra SATA HDD</a></li>
                <li class="third-level"><a href="#firmware">Firmware</a></li>
                <li class="third-level"><a href="#installation-details">Installation Details</a></li>
            <li class="second-level"><a href="#mounting-hdds">Mounting HDDs</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="provisioning">Provisioning</h1>
<h2 id="initial-set-up">Initial Set-Up</h2>
<p>For the duration of this guide we will be referencing a Debian 9.5 base system.
The names of packages and specific installation steps will almost certainly differ
if a different distro or Debian version is used.</p>
<h2 id="disk-partitioning-scheme">Disk Partitioning Scheme</h2>
<p>The Poweredge 1950 in question is equipped with 4x 2.5" HDD bays that connect to the
back-plane and PERC 6/i RAID controller. In addition the optical drive bay was removed
and replaced with a housing for an additional 2.5" HDD which is attached to the internal
SATA 1.0 port.</p>
<p>These drive bays are populated with the following hardware:</p>
<table>
<thead>
<tr>
<th>Back-plane</th>
<th>Independent SATA 1.0</th>
</tr>
</thead>
<tbody>
<tr>
<td>4 x Seagate Constellation.2 1 TB, 7200 RPM</td>
<td>1 x Seagate Spinpoint M9T 2TB, 5400 RPM</td>
</tr>
</tbody>
</table>
<p>These resources will be used in the following way:</p>
<table>
<thead>
<tr>
<th>Base OS</th>
<th>General Storage</th>
<th>Low Speed NAS</th>
</tr>
</thead>
<tbody>
<tr>
<td>120 GB RAID 0</td>
<td>~2.67 GB RAID 5</td>
<td>~ 2 TB Independent</td>
</tr>
</tbody>
</table>
<p>In practice a RAID 5 array with the hardware listed above yields read/write speeds of
\~ 300 MB/s and the independent 2 TB drive yields \~ 100 MB/s. We want to reserve the
(relatively) high speed volumes for use by our base OS and for applications where
I/O performance might be a consideration. The SATA 1.0 port on the main
board is not managed by the RAID controller and any attached HDD has to be used as a totally independent
volume. This means that we will have access to almost the full storage available on
the disk, but lower I/O speeds. Because of this we reserve the 2 TB volume for
long-term storage or for applications where I/O performance is not critical.</p>
<h3 id="setting-up-raid-arrays">Setting up RAID Arrays</h3>
<h3 id="setting-up-extra-sata-hdd">Setting up Extra SATA HDD</h3>
<h3 id="firmware">Firmware</h3>
<p>The Ethernet adapters used by the Poweredge 1950 require firmware from the
<code>firmware-bnx2_0.43</code> package in order to operate. This firmware can be installed during initial
set-up or afterwards. For obvious reasons it's easier to install this package
<em>during</em> initial installation, because once the system is set-up without it we
won't have access to the internet and will need to install the package manually
using removable media of some sort.</p>
<h4 id="base-non-free-livecd">Base + Non-Free LiveCD</h4>
<p>There is <a href="http://cdimage.debian.org/cdimage/unofficial/non-free/cd-including-firmware/9.5.0+nonfree/amd64/iso-cd/">a special LiveCD</a> image that includes the base Debian 9.5
system and all of the "non-free" firmware, of which the <code>bnx2</code> firmware is a subset.
Using this image should mean the Ethernet adapters function normally out-of-the-box.</p>
<h4 id="manual-installation-during-install">Manual Installation During Install</h4>
<p>Alternatively a base Debian image can be used and the firmware can be loaded
during the LiveCD installation. The <a href="http://cdimage.debian.org/cdimage/unofficial/non-free/firmware/stretch/current/">compressed firmware file package</a>
needs to be downloaded, uncompressed, and placed on a removal media device.
During installation the missing <code>firmware-bnx2_0.43</code> will be identified. By selecting <code>firmware-bnx2_0.43.all.deb</code> file on the previously prepared removal media device,
the missing firmware will be installed and the Ethernet adapters should function normally.</p>
<h4 id="manual-installation-after-install">Manual Installation After Install</h4>
<p>We can also install our missing firmware <em>after</em> the base OS is set-up. Once again
we need to grab the <a href="http://cdimage.debian.org/cdimage/unofficial/non-free/firmware/stretch/current/">compressed firmware file package</a>
 uncompress it, and place the uncompressed files on a removal media device.</p>
<p>We can then copy the <code>firmware-bnx2_0.43.all.deb</code> file onto the host system and
install it with <code>dpkg</code>.</p>
<pre><code class="shell">sudo dpkg -i firmware-bnx2_0.43.all.deb
</code></pre>

<p>Since we didn't have a network connection accessible during the LiveCD installation
our <code>apt</code> sources will be set to local LiveCD versions. Now that we have the proper
firmware installed to use our Ethernet adapter we need to change out apt sources
to reference the main Debian repos instead of these local versions.</p>
<p>We need to open up <code>/etc/apt/sources.list</code> using whatever text editor we choose...</p>
<pre><code class="shell">sudo nano /etc/apt/sources.list
</code></pre>

<p>... and replace the entire file with the following.</p>
<pre><code class="apacheconf">deb http://deb.debian.org/debian stretch main
deb-src http://deb.debian.org/debian stretch main

deb http://deb.debian.org/debian-security/ stretch/updates main
deb-src http://deb.debian.org/debian-security/ stretch/updates main

deb http://deb.debian.org/debian stretch-updates main
deb-src http://deb.debian.org/debian stretch-updates main
</code></pre>

<p>Unfortunately these changes will result in target conflicts.. In order to resolve these conflicts we simply need to remove the file
<code>base.list</code> under <code>/etc/apt/source.list.d</code>.</p>
<pre><code class="shell">sudo rm /etc/apt/source.list.d/base.list
</code></pre>

<p>With these changes in place we can update our <code>apt</code> sources to reference the
standard Debian repos instead of the LiveCD local ones.</p>
<pre><code class="shell">sudo apt-get update
</code></pre>

<h3 id="installation-details">Installation Details</h3>
<p>We will be installing the OS on the small ~120 GB RAID 0 partition we made earlier.</p>
<p>If we used the "guided partition" option offered by the Debian installer it will
automatically allocated ~64 GB of space to <code>swap</code>. Since our system has 64 GB of RAM
this is a truly excessive amount of <code>swap</code> space. We can either partition our system
manually during installation, or after installation using <code>gparted</code> or similar.</p>
<h2 id="mounting-hdds">Mounting HDDs</h2>
<p>By default only the small 120 GB partition that holds the OS will be mounted on
boot. We need to set up mount points for our 2.6 TB RAID 5 array and the
independent 2 TB HDD.</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>
    <script src="../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2018-09-30 20:27:17
-->
